<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ИНФОРМАЦИОННАЯ САЙТА</title>
  <link rel="icon" type="image/webp" href="https://line-0707.github.io/Acts/source/icon.webp">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f4f4f9;
      color: #333;
    }

    .header {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }

    .header img {
      width: 50px;
      height: 50px;
      margin-right: 15px;
    }

    .header h1,
    .header h2 {
      margin: 0;
    }

    .header h1 {
      font-size: 2em;
    }

    .header h2 {
      font-size: 1.2em;
      font-weight: normal;
      color: #555;
    }

    #table-container {
      border: 1px solid #ccc;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      background-color: #fff;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th,
    td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }

    thead th {
      background-color: #007bff;
      color: white;
      font-weight: bold;
    }

    tbody tr:nth-child(even) {
      background-color: #f2f2f2;
    }

    tbody tr:hover {
      background-color: #e9ecef;
    }

    .loader {
      text-align: center;
      padding: 20px;
      font-size: 1.2em;
    }
  </style>
</head>

<body>

  <div class="header">
    <img src="https://line-0707.github.io/Acts/source/icon.webp" alt="Site Icon">
    <div>
      <h1>ИНФОРМАЦИОННАЯ САЙТА</h1>
      <h2>Сводка опубликованных документов и ресурсов</h2>
    </div>
  </div>

  <div id="table-container">
    <div class="loader">Loading data from Google Sheet...</div>
  </div>

  <script>
    // URL of the Google Sheet published as a CSV.
    // The /gviz/tq?tqx=out:csv part is important for direct CSV download.
    const sheetUrl = 'https://docs.google.com/spreadsheets/d/1Rvr4RwirK8-ygKXG3Qyq6Bf4OvGZ7YjsxiAb4ZI2Xeo/gviz/tq?tqx=out:csv';

    // Wait for the webpage to fully load before running the script.
    document.addEventListener('DOMContentLoaded', function () {
      fetch(sheetUrl)
        .then(response => response.text())
        .then(csvText => {
          const tableContainer = document.getElementById('table-container');

          // Parse the CSV text into a 2D array (rows and cells).
          // This handles potential commas inside quoted strings.
          const rows = csvText.split('\\n').map(row => {
            const results = [];
            let inQuote = false;
            let cell = '';
            for (let i = 0; i < row.length; i++) {
              const char = row[i];
              if (char === '"') {
                inQuote = !inQuote;
              } else if (char === ',' && !inQuote) {
                results.push(cell);
                cell = '';
              } else {
                cell += char;
              }
            }
            results.push(cell);
            return results;
          });

          // Create the HTML table element.
          const table = document.createElement('table');

          // Create the table header.
          const thead = document.createElement('thead');
          const headerRow = document.createElement('tr');
          rows[0].forEach(headerText => {
            const th = document.createElement('th');
            th.textContent = headerText;
            headerRow.appendChild(th);
          });
          thead.appendChild(headerRow);
          table.appendChild(thead);

          // Create the table body with the rest of the data.
          const tbody = document.createElement('tbody');
          for (let i = 1; i < rows.length; i++) {
            const rowData = rows[i];
            // Skip empty rows
            if (rowData.length > 1 || (rowData.length === 1 && rowData[0] !== '')) {
              const tr = document.createElement('tr');
              rowData.forEach(cellText => {
                const td = document.createElement('td');
                td.textContent = cellText;
                tr.appendChild(td);
              });
              tbody.appendChild(tr);
            }
          }
          table.appendChild(tbody);

          // Clear the "Loading..." message and display the table.
          tableContainer.innerHTML = '';
          tableContainer.appendChild(table);
        })
        .catch(error => {
          // Handle any errors that occur during fetching.
          console.error('Error fetching or parsing sheet data:', error);
          document.getElementById('table-container').textContent = 'Error: Could not load data from the Google Sheet. Please ensure it is published to the web as a CSV.';
        });
    });
  </script>

</body>

</html>